@using ReadExcel.Models
@model IEnumerable<UserModel>
@{
    Layout = "_Layout";
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Users</title>
</head>
<body>
        <div class="row">
            <div class="col-lg-4">
                <h1>Read Excel</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4">
                <label contenteditable="false">Scegli il file .xlsx da caricare</label>
            </div>
            <div class="col-lg-4">
                @using (Html.BeginForm("Index", "User", FormMethod.Post, new { enctype = "multipart/form-data" }))
                {
                    <input type="file" name="elementName" accept=".xlsx,application/msexcel" />
                    <br />
                    <input type="submit" value="Carica File" name="caricaFile" />
                    <input type="text" name="filtro" placeholder="inserisci il testo da cercare" />
                    <br /><br />
                }
            </div>
        </div>
    <div class="row">
        <div class="col-lg-4">
            <label contenteditable="false">Cliccare sul pulsante per caricare il file .xlsx di esempio</label>
        </div>
        <div class="col-lg-4">
            @using (Html.BeginForm("Index", "User", FormMethod.Post))
            {
                <input type="submit" value="Get Users" name="GetUser" />
                <input type="text" name="filtro" placeholder="inserisci il testo da cercare" />
            }
        </div>
    </div>
    <div class="row">
        <hr />
        <div class="col-lg-4"></div>
        <div class="col-lg-4">
            @if (Model.Count() > 0)
            {

                <table cellpadding="0" cellspacing="0" border="1">
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                    </tr>
                    @foreach (UserModel user in Model)
                    {
                        <tr>
                            <td>@user.Name</td>
                            <td>@user.Email</td>
                            <td>@user.Phone</td>
                        </tr>
                    }
                </table>
            }

        </div>
    </div>
    
</body>
</html>